$(document).ready(function(){function e(){window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?$("body").addClass("dark-mode"):$("body").removeClass("dark-mode")}e(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e),$.get("https://peps.ulaval.ca/activite/bains-libres",function(e){try{var t=(new DOMParser).parseFromString(e,"text/html").querySelector("div.accordion.schedule");if(t){var a=t.querySelectorAll("div.panel");if(0===a.length)$("#loading").text("Aucun horaire trouvAc.");else{let r=$("#schedule");r.empty(),a.forEach((e,t)=>{var a;6<=t||($(e).find("svg").remove(),t=$(e).find(".btn-panel").text().trim(),$(e).find(".btn-panel").remove(),$(e).find(".activite-post-it").each(function(){$(this).find("p").first().prepend('<i class="fa-solid fa-note-sticky icon-small"></i> ')}),$(e).find("h5").replaceWith(function(){let e="";var t=$(this).text().trim().toLowerCase();switch(!0){case t.includes("heure"):e='<i class="fa-solid fa-clock icon-small"></i>';break;case t.includes("informations"):e='<i class="fa-solid fa-circle-info icon-small"></i>';break;case t.includes("configuration"):e='<i class="fa-solid fa-water icon-small"></i>'}return`<h3>${e} ${$(this).text().trim()}</h3>`}),$(e).find(".activite-schedule-row").each(function(){$(this).is(":last-child")||$(this).after('<hr class="thin-divider">')}),a=t.toLowerCase().startsWith("samedi")||t.toLowerCase().startsWith("dimanche"),a=$(`<div class="col">
              <div class="card h-100 ${a?"weekend-card":""}">
                <div class="card-header">
                  <h2 class='card-title'>${t}</h2>
                </div>
                <div class="card-body">
                  <div class="card-text mt-2">
                    ${e.innerHTML}
                  </div>
                </div>
              </div>
            </div>`),r.append(a))}),$("#loading").hide();try{window.dispatchEvent(new CustomEvent("schedule:ready"))}catch(e){}}}else $("#loading").text("Impossible de trouver les horaires.")}catch(e){console.error("Erreur lors de l'analyse des horaires :",e),$("#loading").text("Une erreur est survenue.")}})}),(()=>{let r=!1,i=["heure","informations","configuration"],n={heure:new Map,informations:new Map,configuration:new Map},o={heure:new Set,informations:new Set,configuration:new Set},s=new Set;function a(e){return e.replace(/\s+/g," ").trim()}function l(){i.forEach(e=>n[e].clear()),document.querySelectorAll("#schedule .section[data-section]").forEach(e=>{let r=e.getAttribute("data-section");i.includes(r)&&(e=>{let t=Array.from(e.querySelectorAll("li, .activite-schedule-row, p, tr, h4, h5, span")).map(e=>a(e.textContent||"")).filter(e=>0<e.length);return 0===t.length&&(t=(e.textContent||"").split(/\n|â€¢|\u2022| - | \| /).map(a).filter(e=>0<e.length)),Array.from(new Set(t))})(e).forEach(e=>{var t=e.toLowerCase(),a=n[r];a.set(t,{label:e,count:(a.get(t)?.count||0)+1})})})}function c(){document.querySelectorAll("#schedule .card").forEach(e=>{e.classList.toggle("d-none",!(e=>{for(var a of i){var r=o[a];if(0!==r.size){a=e.querySelector(`.section[data-section="${a}"]`);if(!a)return;let t=(a.textContent||"").toLowerCase();if(!Array.from(r).some(e=>t.includes(e.toLowerCase())))return}}if(0<s.size){var t,n=(e.textContent||"").toLowerCase();for(t of s)if(!n.includes(t.toLowerCase()))return}return 1})(e))})}function d(){let r=(document.getElementById("searchInput")?.value||"").trim().toLowerCase();var e=document.getElementById("search-suggestions");if(e)if(r){let a=new Map;i.forEach(e=>{n[e].forEach(e=>{var t=e.label.toLowerCase();t.includes(r)&&a.set(t,e.label)})});var t=Array.from(a.values()).sort((e,t)=>e.localeCompare(t,"fr")).slice(0,30);e.innerHTML=t.map(e=>{var t=s.has(e)?"disabled":"";return`<button type="button" class="btn btn-sm btn-outline-secondary" data-label="${encodeURIComponent(e)}" ${t}>${e}</button>`}).join(""),e.querySelectorAll("button[data-label]").forEach(t=>{t.addEventListener("click",()=>{var e=decodeURIComponent(t.getAttribute("data-label")||"");s.add(e),u(),c(),d()})})}else e.innerHTML=""}function u(){var e,t=document.getElementById("search-selected");t&&(e=Array.from(s).sort((e,t)=>e.localeCompare(t,"fr")),t.innerHTML=e.map(e=>`
      <span class="badge text-bg-secondary">
        ${e}
        <button type="button" class="btn btn-sm btn-link text-white ms-1 p-0 align-baseline" data-remove="${encodeURIComponent(e)}" title="Retirer">&times;</button>
      </span>
    `).join(""),t.querySelectorAll("button[data-remove]").forEach(t=>{t.addEventListener("click",()=>{var e=decodeURIComponent(t.getAttribute("data-remove")||"");s.delete(e),u(),c(),d()})}))}function e(){if(!r){var e,t=document.getElementById("schedule");if(t&&0!==t.children.length){document.getElementById("filtersBar")||(t=document.querySelector(".container"))&&((a=document.createElement("div")).id="filtersBar",a.className="mb-3",a.innerHTML=`
      <div class="row gy-3 align-items-start">
        <div class="col-12 col-lg-4">
          <h6 class="mb-2"><i class="fa-solid fa-clock"></i> Heures</h6>
          <div id="opts-heure" class="filters-list small"></div>
        </div>
        <div class="col-12 col-lg-4">
          <h6 class="mb-2"><i class="fa-solid fa-circle-info"></i> Informations</h6>
          <div id="opts-informations" class="filters-list small"></div>
        </div>
        <div class="col-12 col-lg-4">
          <h6 class="mb-2"><i class="fa-solid fa-water"></i> Configuration</h6>
          <div id="opts-configuration" class="filters-list small"></div>
        </div>
        <div class="col-12">
          <div class="input-group" style="max-width: 520px;">
            <span class="input-group-text"><i class="fa-solid fa-magnifying-glass"></i></span>
            <input id="searchInput" type="search" class="form-control" placeholder="Rechercher dans toutes les sections...">
            <button id="clearSearch" class="btn btn-outline-secondary" type="button" title="Effacer">&times;</button>
          </div>
          <div id="search-suggestions" class="mt-2 d-flex flex-wrap gap-2"></div>
          <div id="search-selected" class="mt-2 d-flex flex-wrap gap-2"></div>
        </div>
      </div>
    `,e=document.getElementById("schedule"),t.insertBefore(a,e||t.firstChild)),document.querySelectorAll("#schedule .card .card-text").forEach(e=>{e.querySelector(".section[data-section]")||Array.from(e.querySelectorAll("h3")).forEach(t=>{var e=(t.textContent||"").trim().toLowerCase();let a=null;if(e.includes("heure")?a="heure":e.includes("informations")?a="informations":e.includes("configuration")&&(a="configuration"),a){var r=document.createElement("div");r.className="section",r.setAttribute("data-section",a),t.parentNode.insertBefore(r,t);let e=t;for(;e;){var n=e.nextSibling;if(r.appendChild(e),!n||1===n.nodeType&&"H3"===n.tagName)break;e=n}}})}),l(),i.forEach(r=>{var e,t=document.getElementById("opts-"+r);t&&(e=Array.from(n[r].values()).sort((e,t)=>e.label.localeCompare(t.label,"fr")),t.innerHTML=e.map((e,t)=>{var t=`filter-${r}-`+t,a=o[r].has(e.label)?"checked":"";return`
          <div class="form-check">
            <input class="form-check-input" type="checkbox" value="${encodeURIComponent(e.label)}" id="${t}" ${a}>
            <label class="form-check-label" for="${t}">${e.label} <span class="text-muted">(${e.count})</span></label>
          </div>`}).join(""),t.querySelectorAll('input[type="checkbox"]').forEach(t=>{t.addEventListener("change",()=>{var e=decodeURIComponent(t.value);t.checked?o[r].add(e):o[r].delete(e),c()})}))});{let e=document.getElementById("searchInput");var a=document.getElementById("clearSearch");e&&e.addEventListener("input",d),a&&a.addEventListener("click",()=>{e&&(e.value=""),d()})}c(),d(),u(),r=!0}}}window.addEventListener("schedule:ready",e),document.addEventListener("DOMContentLoaded",()=>setTimeout(e,0))})(),"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("sw.js").catch(e=>console.warn("SW registration failed:",e))});
//# sourceMappingURL=app.min.js.map